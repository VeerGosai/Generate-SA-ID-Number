<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generate SA ID Numbers</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }

    .container {
      width: 80%;
      margin: 20px auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    h3 {
      text-align: center;
      color: #333;
    }

    label {
      font-weight: bold;
    }

    .input-group {
      margin-bottom: 15px;
    }

    #result {
      margin-top: 20px;
      background-color: #d9edf7;
      padding: 10px;
      border-radius: 5px;
      color: #31708f;
    }

    #expertOptions {
      background-color: #f5f5f5;
      padding: 10px;
      margin-top: 20px;
      border-radius: 5px;
    }

    #showExpertOptions a {
      cursor: pointer;
      color: #337ab7;
      text-decoration: none;
    }

    .btn {
      display: inline-block;
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      text-align: center;
      cursor: pointer;
      border: none;
    }

    .btn:hover {
      background-color: #0056b3;
    }

    textarea {
      width: 100%;
      height: 200px;
    }
  </style>

  <script>
    function calculateCheckDigit(digitsAsString) {
      const digits = digitsAsString.replace(/\D/g, '').split('').map(d => Number(d));
      const checkSum = digits.reverse().map((d, ix) => {
        if (ix % 2 === 0) {
          d *= 2;
          if (d > 9) d -= 9;
        }
        return d;
      }).reduce((memo, d) => memo += d, 0);
      return checkSum * 9 % 10;
    }

    function showIdNumber() {
      const form = document.forms.f1;
      const values = [
        form.year, form.month, form.day,
        form.gender,
        { value: form.sequence.value || '896' },
        { value: form.cship.value || '0' },
        { value: '8' }
      ];

      const withoutCheckDigit = values.map(e => e.value).join('');
      const idNumber = withoutCheckDigit + calculateCheckDigit(withoutCheckDigit);

      document.getElementById('result').innerHTML = `<p><strong>Generated ID:</strong> ${idNumber}</p>`;
    }

    function generateMultipleIds() {
      const form = document.forms.f1;
      const numberOfIds = document.getElementById('idCount').value;
      const ids = [];

      for (let i = 0; i < numberOfIds; i++) {
        const values = [
          form.year, form.month, form.day,
          form.gender,
          { value: form.sequence.value || '896' },
          { value: form.cship.value || '0' },
          { value: '8' }
        ];

        const withoutCheckDigit = values.map(e => e.value).join('');
        const idNumber = withoutCheckDigit + calculateCheckDigit(withoutCheckDigit);
        ids.push(idNumber);
      }

      const file = new Blob([ids.join('\n')], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(file);
      a.download = 'generated-ids.txt';
      a.click();
    }

    function showExpertOptions() {
      document.getElementById('showExpertOptions').style.display = 'none';
      document.getElementById('expertOptions').style.display = 'block';
    }

    function addOptions(id, from, to, defaultValue) {
      const selectElement = document.getElementById(id);
      const values = Array.from({ length: to - from + 1 }, (_, i) => i + from);
      const options = values.map(v => {
        const isDefault = defaultValue && defaultValue === String(v);
        return `<option value="${v}" ${isDefault ? 'selected="selected"' : ''}>${v}</option>`;
      }).join('');
      selectElement.innerHTML = options;
    }

    window.onload = () => {
      const year = new Date().getFullYear();
      addOptions('year', 1900, year);
      addOptions('month', 1, 12);
      addOptions('day', 1, 31);
      addOptions('sequence', 0, 999, '800');
    };
  </script>

</head>
<body>

  <div class="container">
    <h3>Generate (Fake) South-African ID Numbers</h3>

    <form id="f1" name="f1" onsubmit="showIdNumber(); return false">
      <div class="input-group">
        <label for="year">Year of Birth</label>
        <select id="year" name="year"></select>
      </div>
      <div class="input-group">
        <label for="month">Month of Birth</label>
        <select id="month" name="month"></select>
      </div>
      <div class="input-group">
        <label for="day">Day of Birth</label>
        <select id="day" name="day"></select>
      </div>
      <div class="input-group">
        <input type="radio" name="gender" id="female" value="4" checked />
        <label for="female">Female</label><br />
        <input type="radio" name="gender" id="male" value="5" />
        <label for="male">Male</label>
      </div>

      <div id="showExpertOptions">
        <a onclick="showExpertOptions()">Show expert options</a>
      </div>

      <div style="display: none;" id="expertOptions">
        <div class="input-group">
          <label for="sequence">Sequence</label>
          <select id="sequence" name="sequence"></select>
        </div>
        <div class="input-group">
          <input type="radio" name="cship" id="citizen" value="0" checked />
          <label for="citizen">Citizen</label><br />
          <input type="radio" name="cship" id="resident" value="1" />
          <label for="resident">Resident</label>
        </div>
      </div>

      <div class="input-group">
        <label for="idCount">Number of IDs to generate</label>
        <input type="number" id="idCount" class="form-control" min="1" />
      </div>

      <button class="btn" type="submit">Generate Single ID</button>
      <button class="btn" type="button" onclick="generateMultipleIds()">Generate Multiple IDs</button>
    </form>

    <div id="result">Hint: submit the form to get an ID number.</div>

    <h3>More Information</h3>

    <p>South African ID numbers follow the format:</p>

    <p id="latex"></p>

    <p>The formula for generating ID numbers is \( \text{ID} = YYMMDDGSSSCA \), where:</p>
    <ul>
      <li>\( YYMMDD \) is the date of birth.</li>
      <li>\( G \) is gender (4 for females and 5 for males).</li>
      <li>\( SSS \) is a daily sequence number.</li>
      <li>\( C \) indicates citizenship (0 for citizens, 1 for residents).</li>
      <li>\( A \) is a checksum calculated using the Luhn algorithm.</li>
    </ul>
  </div>

  <!-- MathJax for LaTeX -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</body>
</html>
